<!DOCTYPE html>
<html lang="hr">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#0a0a1a" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="SharkTrack" />
    <title>SharkTrack ğŸ¦ˆ</title>
    <link rel="manifest" href="manifest.json" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="css/style.css?v=2" />
</head>

<body>
    <!-- ... (rest of body) ... -->
    <script src="js/ui.js?v=2"></script>
    <script src="js/planner.js?v=2"></script>
    <script src="js/app.js?v=2"></script>
</body>

<!-- ===================== HEADER ===================== -->
<header class="app-header">
    <div class="header-left">
        <img src="SharpShark_Logo.png" alt="SharpShark" class="header-logo" />
        <span class="logo">ğŸ¦ˆ SharkTrack</span>
    </div>
    <div class="header-right">
        <div class="gps-status" id="gpsStatus">
            <span class="gps-dot"></span>
            <span class="gps-label">GPS...</span>
        </div>
        <div class="online-status" id="onlineStatus">
            <span class="online-dot"></span>
        </div>
    </div>
</header>

<!-- ===================== OFFLINE BANNER ===================== -->
<div class="offline-banner" id="offlineBanner">
    ğŸ“µ Offline â€” lokacije se spremaju lokalno i sync-aju kad doÄ‘e signal
</div>

<!-- ===================== GEOFENCE ALERT ===================== -->
<div class="geofence-alert" id="geofenceAlert">
    <div class="geofence-content">
        <span class="geofence-icon">ğŸ“</span>
        <div class="geofence-text">
            <strong id="geofenceTitle">Blizu stare lokacije!</strong>
            <span id="geofenceSubtitle"></span>
        </div>
        <button class="geofence-close" id="geofenceClose">âœ•</button>
    </div>
    <div class="geofence-actions">
        <button class="btn-geofence-nav" id="geofenceNav">ğŸ—ºï¸ Navigiraj</button>
        <button class="btn-geofence-update" id="geofenceUpdate">âœï¸ AÅ¾uriraj status</button>
    </div>
</div>

<!-- ===================== MAIN CONTENT ===================== -->
<main class="app-main">

    <!-- ===== TAB: HOME ===== -->
    <section class="tab-content active" id="tab-home">

        <!-- BIG SAVE BUTTON -->
        <div class="save-section">
            <button class="btn-save" id="btnSave">
                <span class="btn-save-icon">ğŸ“</span>
                <span class="btn-save-text">SPREMI LOKACIJU</span>
                <span class="btn-save-sub">Tap za trenutnu GPS poziciju</span>
            </button>
            <div class="save-feedback" id="saveFeedback"></div>
        </div>

        <!-- QUICK TAGS -->
        <div class="section-card">
            <h3 class="section-title">Brzi tag <span class="tag-optional">(opcionalno)</span></h3>
            <div class="tags-grid">
                <button class="tag-btn" data-tag="Stambeno">ğŸ <span>Stambeno</span></button>
                <button class="tag-btn" data-tag="Industrijsko">ğŸ­<span>Industrijsko</span></button>
                <button class="tag-btn" data-tag="Poslovno">ğŸ¢<span>Poslovno</span></button>
                <button class="tag-btn" data-tag="Nepoznato">â“<span>Nepoznato</span></button>
            </div>
        </div>

        <!-- NOTE -->
        <div class="section-card">
            <h3 class="section-title">BiljeÅ¡ka <span class="tag-optional">(opcionalno)</span></h3>
            <div class="note-row">
                <input type="text" class="note-input" id="noteInput" placeholder="Kratki opis..." maxlength="100" />
                <button class="btn-voice" id="btnVoice" title="Glasovni unos">ğŸ¤</button>
            </div>
        </div>

        <!-- PHOTO -->
        <div class="section-card">
            <h3 class="section-title">Foto <span class="tag-optional">(opcionalno)</span></h3>
            <div class="photo-row">
                <button class="btn-photo" id="btnPhoto">ğŸ“¸ Slikaj</button>
                <div class="photo-preview-wrap" id="photoPreviewWrap">
                    <img class="photo-preview" id="photoPreview" src="" alt="Preview" />
                    <button class="photo-remove" id="photoRemove">âœ•</button>
                </div>
            </div>
            <input type="file" id="photoInput" accept="image/*" capture="environment" style="display:none" />
        </div>

        <!-- ROUTE TRACKING -->
        <div class="section-card route-card">
            <div class="route-header">
                <div>
                    <h3 class="section-title">Snimanje rute</h3>
                    <span class="route-status" id="routeStatus">Nije aktivno</span>
                </div>
                <button class="btn-route-toggle" id="btnRouteToggle">
                    <span id="routeToggleIcon">â–¶</span>
                    <span id="routeToggleLabel">Start</span>
                </button>
            </div>
            <div class="route-stats" id="routeStats" style="display:none">
                <div class="route-stat">
                    <span class="route-stat-val" id="routePoints">0</span>
                    <span class="route-stat-lbl">toÄaka</span>
                </div>
                <div class="route-stat">
                    <span class="route-stat-val" id="routeDuration">00:00</span>
                    <span class="route-stat-lbl">trajanje</span>
                </div>
            </div>
        </div>

        <!-- DAILY SUMMARY -->
        <div class="section-card summary-card">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
                <h3 class="section-title" style="margin-bottom:0;">Danas</h3>
                <button id="btnSendReport" class="btn-nav"
                    style="background:var(--green); color:#000; font-weight:700; border-radius:50px; padding:6px 14px; border:none; cursor:pointer; font-size:0.75rem;">ğŸ“§
                    PoÅ¡alji izvjeÅ¡taj</button>
            </div>
            <div class="summary-stats">
                <div class="summary-stat">
                    <span class="summary-val" id="summaryCount">0</span>
                    <span class="summary-lbl">lokacija</span>
                </div>
                <div class="summary-stat">
                    <span class="summary-val" id="summaryPending">0</span>
                    <span class="summary-lbl">Äeka sync</span>
                </div>
            </div>
        </div>

    </section>

    <!-- ===== TAB: LISTA ===== -->
    <section class="tab-content" id="tab-list">
        <div class="list-header">
            <h2>ZabiljeÅ¾ene lokacije</h2>
            <div class="list-filter">
                <button class="filter-btn active" data-filter="all">Sve</button>
                <button class="filter-btn" data-filter="today">Danas</button>
                <button class="filter-btn" data-filter="week">Tjedan</button>
            </div>
        </div>
        <div class="locations-list" id="locationsList">
            <div class="empty-state">
                <span>ğŸ“</span>
                <p>JoÅ¡ nema zabiljeÅ¾enih lokacija</p>
            </div>
        </div>
    </section>

    <!-- ===== TAB: PLANNER ===== -->
    <section class="tab-content" id="tab-planner">
        <div class="list-header">
            <h2>Kamo idemo? ğŸ—ºï¸</h2>
            <p style="font-size:0.8rem; color:#888;">PronaÄ‘i kupce na ruti do odrediÅ¡ta (30km)</p>
        </div>

        <div class="planner-card">
            <div class="planner-input-group">
                <input type="text" id="plannerDest" class="planner-input" placeholder="UpiÅ¡i grad (npr. Rijeka)...">
                <button id="plannerSearchBtn" class="btn-planner-search">TRAÅ½I ğŸ”</button>
            </div>
            <div id="plannerStatus" class="planner-status"></div>
        </div>

        <div id="plannerResults" class="locations-list">
            <!-- Results will be injected here -->
        </div>
    </section>

    <!-- ===== TAB: MAPA ===== -->
    <section class="tab-content" id="tab-map">
        <div id="map"></div>
    </section>

</main>

<!-- ===================== BOTTOM NAV ===================== -->
<nav class="bottom-nav">
    <button class="nav-btn active" data-tab="tab-home" id="navHome">
        <span class="nav-icon">ğŸ </span>
        <span class="nav-label">PoÄetna</span>
    </button>
    <button class="nav-btn" data-tab="tab-list" id="navList">
        <span class="nav-icon">ğŸ“‹</span>
        <span class="nav-label">Lista</span>
    </button>
    <button class="nav-btn" data-tab="tab-planner">
        <span class="nav-icon">ğŸš€</span>
        <span class="nav-label">Planer</span>
    </button>
    <button class="nav-btn" data-tab="tab-map" id="navMap">
        <span class="nav-icon">ğŸ—ºï¸</span>
        <span class="nav-label">Mapa</span>
    </button>
</nav>

<!-- ===================== STATUS UPDATE MODAL ===================== -->
<div class="modal-overlay" id="statusModal">
    <div class="modal">
        <h3>AÅ¾uriraj status</h3>
        <div class="status-options">
            <button class="status-btn" data-status="Nova">ğŸ†• Nova</button>
            <button class="status-btn" data-status="Kontaktirano">ğŸ“ Kontaktirano</button>
            <button class="status-btn" data-status="Ponuda poslana">ğŸ“„ Ponuda poslana</button>
            <button class="status-btn" data-status="Zatvoren posao">âœ… Zatvoren posao</button>
            <button class="status-btn" data-status="Nije zainteresiran">âŒ Nije zainteresiran</button>
        </div>
        <button class="modal-close" id="statusModalClose">Zatvori</button>
    </div>
</div>

<!-- ===================== EDIT LOCATION MODAL ===================== -->
<div class="modal-overlay" id="editModal">
    <div class="modal">
        <h3>Uredi lokaciju âœï¸</h3>
        <input type="hidden" id="editRowIndex">

        <div class="input-group">
            <label>Kontakt osoba / Info</label>
            <input type="text" id="editContact" class="planner-input" placeholder="Ime, broj, email...">
        </div>

        <div class="input-group">
            <label>BiljeÅ¡ka</label>
            <textarea id="editNote" class="planner-input" rows="3" placeholder="Dodaj biljeÅ¡ku..."></textarea>
        </div>

        <div class="input-group">
            <label>Fotografija</label>
            <div class="photo-edit-area">
                <img id="editPhotoPreview" class="edit-photo-preview" src="" style="display:none;">
                <label for="editPhotoInput" class="btn-photo-upload">ğŸ“¸ Dodaj / Promijeni sliku</label>
                <input type="file" id="editPhotoInput" accept="image/*" capture="environment" style="display:none;">
            </div>
        </div>

        <div class="modal-actions">
            <button class="modal-close" id="editModalClose" style="background:var(--bg3);">Odustani</button>
            <button class="modal-save" id="editModalSave"
                style="background:var(--accent); color:#000; font-weight:700;">SPREMI</button>
        </div>
    </div>
</div>

<!-- ===================== TOAST ===================== -->
<div class="toast" id="toast"></div>

<!-- ===================== SCRIPTS ===================== -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="js/offline.js"></script>
<script src="js/sheets.js"></script>
<script src="js/gps.js"></script>
<script src="js/photo.js"></script>
<script src="js/route.js"></script>
<script src="js/geofence.js"></script>
<script src="js/ui.js"></script>
<script src="js/planner.js"></script>
<script src="js/app.js"></script>

</body>

</html>